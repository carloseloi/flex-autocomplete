<?xml version="1.0" encoding="utf-8"?>
<mx:Application 
	xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:components="com.hillelcoren.components.*"
	width="100%" height="100%"
	verticalAlign="middle" horizontalAlign="center"
	initialize="init()">
	
	<mx:Script>
		<![CDATA[
			import com.hillelcoren.utils.StringUtils;
			import mx.collections.ArrayCollection;
			
			[Bindable]
			private var _contacts:ArrayCollection;
			
			private function init():void
			{
				_contacts = new ArrayCollection(
				[
					{"name":"Patty Bouvier", "email":"patty@yahoo.com"},
					{"name":"Otto Mann", "email":"otto@gmail.com"},
					{"name":"Nelson Muntz", "email":"nelson@aol.com"},
					{"name":"Herbert Powell", "email":"herbert@gmail.com"},
					{"name":"Troy McClure", "email":"troy@yahoo.com"},
					{"name":"Ralph Wiggum", "email":"ralph@gmail.com"},
					{"name":"Homer Simpson", "email":"homer@aol.com"},
					{"name":"Jasper Beardly", "email":"jasper@yahoo.com"},
					{"name":"Selma Bouvier", "email":"selma@hotmail.com"},
					{"name":"Kent Brockman", "email":"kent@aol.com"},
					{"name":"Jebediah Springfield", "email":"jebediah@gmail.com"},
					{"name":"Maude Flanders", "email":"maude@gmail.com"},
					{"name":"Barney Gumble", "email":"barney@aol.com"},
					{"name":"Julius Hibbert", "email":"julius@hotmail.com"},
					{"name":"Marge Simpson", "email":"marge@gmail.com"},
					{"name":"Bart Simpson", "email":"bart@aol.com"},
					{"name":"Ned Flanders", "email":"ned@gmail.com"},
					
				]);
			}
			
			public function dropDownLabelFunction( item:Object ):String
			{
				var label:String = item.name + " &lt;" + item.email + "&gt;";
				
				var str:String = "";
				var searchStr:String = autocomplete.searchText;
				
				var start:int = label.search(new RegExp(searchStr, "gi"));
				
				str = label.substring(0, start);
				str = str + "<b><u>" + label.substr(start, searchStr.length) + "</u></b>";
				str = str + label.substr(start + searchStr.length, label.length);

				if (autocomplete.isItemSelected( item ))
    			{
    				str = "<font color='" + Consts.COLOR_TEXT_DISABLED + "'>" + str + "</font>";
    			}
    			
    			return str;
			}

			private function filterFunction( item:Object, searchStr:String ):Boolean
			{
				if (StringUtils.anyWordBeginsWith( item.name, searchStr ))
				{
					return true;
				}
				else if (StringUtils.beginsWith( item.email, searchStr ))
				{	
					return true;
				}
				
				return false;
			}
			
		]]>
	</mx:Script>
	
	<mx:Panel width="550" height="400" title="Email Demo"
		paddingBottom="20" paddingTop="20" paddingLeft="20" paddingRight="20">

		<mx:Form width="100%" height="100%">
			<mx:FormItem label="To: " width="100%">				
				<components:AutoComplete id="autocomplete" width="80%" dataProvider="{ _contacts }" 
					isMultiSelect="true" multiSelectLayout="horizontal" isStrict="false"
					labelField="name" dropDownLabelFunction="dropDownLabelFunction" filterFunction="filterFunction"/>
			</mx:FormItem>
			<mx:FormItem label="Subject: " width="100%">
				<mx:TextInput width="80%"/>
			</mx:FormItem>
			<mx:FormItem label="Body: " width="100%" height="100%">
				<mx:TextArea width="80%" height="100%"/>
			</mx:FormItem>
		</mx:Form>
	
	</mx:Panel>
	
</mx:Application>